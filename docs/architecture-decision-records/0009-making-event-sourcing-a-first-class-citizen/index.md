# ADR0009: Making event sourcing a first class citizen

Status: Accepted and active.

## Context

Without EF's change tracker, keeping an aggregate up-to-date with a relational
store may involve significant work: manually scanning an aggregate for changes
and generating SQL, like EF does, is infeasible.

By instead treating the store as an immediately updated read-model, from events
generated by core, change tracking becomes feasible, even across complex
aggregates.

Earlier versions of the sample used domain events to update the relational store
as they were already being emitted by core for auditing.

## Decision

Going forward, the sample becomes explicitly event sourced. It means changing
event names to present tense and renaming the `PersistedDomainEvents` table to
simply `Events`.

The change doesn't preclude defining domain events for cases where one aggregate
needs to notify another. But the sample will not define types for domain events
before they're needed. There's no need as domain events are no longer used for
auditing.

## Consequences

Making event sourcing a first class citizen, the sample becomes more true to the
concepts already involved. Guarantying the replay of events, we're forced to
ensure events are accurate for auditing as well.

With databases gaining JSON support, and the ability to index and query JSON
documents using SQL extensions, going down the MartenDB route of storing read
models as JSON documents could greatly simplify repositories. It would simplify
mapping from a flat SQL result set to an object graph as well as changing
database schemas.
